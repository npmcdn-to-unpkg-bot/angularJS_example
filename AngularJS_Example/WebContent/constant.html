<!DOCTYPE html>
<html ng-app = "constant">
<head>
<meta charset="utf-8">
<title>constant example</title>
<script src="libs/angular/angular.js"></script>
<script type="text/javascript">
	angular.module('constant', [])
	.constant('PI', 3.141592)
	.provider('Cal', [function() {
		var defaultRadius = 10;
		
		this.setDefaultRadius = function (radius) {
			defaultRadius = radius;
		};
		
		// constant는 provider에서도 주입받을 수 있다.
		this.$get = ['PI', function(PI) {
			return {
				getCircleArea : function(radius) {
					var r= radius || defaultRadius;
					return r*r*PI;
				}
			};
		}];
	}])
	//config에서는 provider의 this객체에 접근이 가능하ㅏ므로 setDefaultRadius 호출이 가능하다..
	//첫 번째 인자로 Cal Service Provider를 주이받고, 두 번째 인자로는 PI Service (constant) 를 주입받는다.
	.config (function (CalProvider, PI) {
		CalProvider.setDefaultRadius(5);
		console.log(PI);
	})
	//Cal, PI Service 주입받아 지시자 생성
	.directive('circle', ['Cal', 'PI', function(Cal,PI) {
		//반드시 리턴해야함, 원 그리는 것.
		return {
			restrict : 'E',
			template : '<canvas width="100" height="100"></canvas>',
			link : function (scope, iElement, iAttrs) {
				var context = iElement.find("canvas")[0].getContext('2d');
				var radius = 30;
				
				context.beginPath();
				context.arc(50, 50, radius, 0, 2*PI, false);
				context.fillStyle = 'yellow';
				context.fill();
				context.lineWidth =5;
				context.strokeStyle = '#003300';
				context.stroke();
				iElement.append("<p> 반지름 30px 인 원의 넓이 : " + Cal.getCircleArea(radius)+"px </p>");
			}
		};
	}]);
</script>
</head>
<body>
	<circle></circle>
</body>
</html>